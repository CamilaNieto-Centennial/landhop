{% extends "landhop/layout2.html" %}
{% load static %}

{% block body %}


    <div class="container">
        <div class="row align-items-center">
            <div class="col-12 text-center sight1">
                <h2 class="subtitles" value="sight1" id="sight1">Title Sight</h2>
                <div class="stars-outer">
                    <div class="stars-inner"></div>
                </div>
                <span class="number-rating"></span>
            </div>
        </div>
        <div class="row align-items-center">
            <div class="col-12 col-md-12 col-sm-12 col-xs-12 col-lg-12 subContents">
                <!--<div class="container text-center">-->
                <div class="row">
                    <div class="col-12">
                        <img src="{% static 'landhop/travel1.jpg' %}" alt="" style="width: 100%; padding-bottom: 1em;">
                    </div>
                </div>
                <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Repellat illo earum porro, neque optio at ex necessitatibus dolor veritatis voluptates illum, accusamus, esse id consequatur fugiat consequuntur natus. Rerum, voluptas. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolores quae, veritatis illum nostrum dolor est nihil nobis possimus ea atque? Doloremque nihil autem rerum quidem accusamus labore enim quos sunt!</p>
                <!--</div>-->
                <h2>Comments</h2>
                <form>
                    <div class="row">
                        <div class="col-12">
                            <div class="mb-3">
                                <div class="form-floating">
                                    <textarea class="form-control" placeholder="Leave a comment here" id="floatingComment" style="height: 100px"></textarea>
                                    <label for="floatingComment">Comment</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 col-md-3 col-sm-12 col-xs-12 col-lg-3">
                            <div class="mb-3">
                                <label for="inputStars" class="form-label">Stars</label>
                                <input type="number" class="form-control" id="rating-control" step="0.1" max="5" placeholder="Rate 1-5">
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary" style="margin-bottom: 2em;">SUBMIT</button>
                </form>
                <div class="alert alert-primary comment-sight1" role="alert">
                    <h5 style="display: inline;"><strong>Username</strong></h5>
                    <div style="display: inline;" id="commentHelp" class="form-text"> | Date</div>
                    <div></div>
                    <div class="stars-outer">
                        <div class="stars-inner"></div>
                    </div>
                    <p>Comment</p>
                </div>

            </div>
        </div>
    </div>





{% endblock %}

{% block script %}
    <script>
        //Run getRatings when DOM loads
        document.addEventListener('DOMContentLoaded', getRatings)

        // Initial ratings
        const ratings = {
            sight1: 4.0
        }

        // Total Stars
        const starsTotal = 5;




        // Form Elements
        const ratingControl = document.getElementById('rating-control');

        // Initialize Sight
        let sight = document.getElementById("sight1").getAttribute('value');;
        console.log(sight)



        // Rating control change
        ratingControl.addEventListener('blur', (e) => {
            const rating = e.target.value;

            // Make sure 5 or under
            if(rating > 5 || rating < 0) {
                alert('Please rate 1-5');
                return;
            }

            // Change rating
            ratings[sight] = rating;

            getRatings();
        })


        // Get ratings
        function getRatings() {
            for (let rating in ratings) {
                //console.log(ratings[rating])
                // Get percentage
                const starPercentage = (ratings[rating] / starsTotal) * 100;
                //console.log(starPercentage)

                // Round to nearest 10
                const starPercentageRounded = `${Math.round(starPercentage / 10) * 10}%`
                console.log(starPercentageRounded)

                // Set width of stars-inner to percentage
                document.querySelector(`.${rating} .stars-inner`).style.width=starPercentageRounded;

                // Add number rating
                document.querySelector(`.${rating} .number-rating`).innerHTML=ratings[rating].toFixed(1)

                // Stars on Comment Section
                document.querySelector(`.comment-${rating} .stars-inner`).style.width=`${Math.round(((ratings['sight1']/ starsTotal) * 100) / 10) * 10}%`

                
            }
            
        }


    </script>
    
{% endblock %}